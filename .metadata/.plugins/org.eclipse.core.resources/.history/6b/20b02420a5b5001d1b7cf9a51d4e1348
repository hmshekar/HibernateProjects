package edbms;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.Scanner;
import java.util.Set;

import customeexception.EmployeeNotFoundException;

public class EmployeeManagementSystemImpl implements EmployeeManagementSystem{
	Scanner scan=new Scanner(System.in);
	Map<String,Employee> db=new LinkedHashMap<>();

	private void dataBase(String  id,String name,int age,double sal) {
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/oracleemp","root","root");
			PreparedStatement ps=connection.prepareStatement("insert into employee values(?,?,?,?)");
			ps.setString(1, id);
			ps.setString(2, name);
			ps.setInt(3, age);
			ps.setDouble(4, sal);
			ps.execute();
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}


	@Override
	public void addEmployee() {
		// TODO Auto-generated method stub
		System.out.println("Enter id:");
		String id=scan.next().toUpperCase();
		System.out.println("Enter Name:");
		String name=scan.next();
		System.out.println("Enter Age:");
		int age=scan.nextInt();
		System.out.println("Enter Salary:");
		double sal=scan.nextDouble();
//		Employee emp=new Employee(name,id, age, sal);

		dataBase(id,name,age,sal);

	}

	@Override
	public void displayEmployee() {
		// TODO Auto-generated method stub
		System.out.println("Enter Id:");
		String id=scan.next().toUpperCase();
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/oracleemp","root","root");
			PreparedStatement ps=connection.prepareStatement("select * from employee where id=?");
			ps.setString(1, id);
			ResultSet rs=ps.executeQuery();
			if(rs.next()) {
				System.out.println("ID: "+rs.getString(1)+"  ,Name:"+rs.getString(2)+"  ,Age: "+rs.getInt(3)+"   ,Sal: "+rs.getDouble(4));
			}
		} 
		catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}


	}

	@Override
	public void displayAllEmployee() {
		// TODO Auto-generated method stub
		System.out.println("From Date base");
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/oracleemp","root","root");
			PreparedStatement ps=connection.prepareStatement("select * from employee");
			ResultSet rs=ps.executeQuery();
			if(rs.next()) {
				System.out.println("ID: "+rs.getString(1)+"  ,Name:"+rs.getString(2)+"  ,Age: "+rs.getInt(3)+"   ,Sal: "+rs.getDouble(4));
			}
		} 
		catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	@Override
	public void removeEmployee() {
		// TODO Auto-generated method stub
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/oracleemp","root","root");
			PreparedStatement ps=connection.prepareStatement("delete from employee where id=?");
			ps.setString(1, scan.next().toUpperCase());
		}
		catch(ClassNotFoundException |SQLException e) {
			e.printStackTrace();
		}

	}

	@Override
	public void removeAllEmployee() {
		// TODO Auto-generated method stub

	}

	@Override
	public void countEmployee() {
		// TODO Auto-generated method stub

	}

	@Override
	public void updateEmployee() {
		// TODO Auto-generated method stub

	}

	@Override
	public void sortEmployee() {
		// TODO Auto-generated method stub

	}

	@Override
	public void displayEmployeeWithHighestSal() {
		// TODO Auto-generated method stub

	}

	@Override
	public void displayEmployeeWithLowestSal() {
		// TODO Auto-generated method stub

	}

}
