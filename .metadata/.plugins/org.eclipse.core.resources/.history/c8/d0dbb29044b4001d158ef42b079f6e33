package com.ty;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;
public class StudentImpl implements StudentManagementSystem{
	Scanner scan=new Scanner(System.in);
	@Override
	public void addStudent() {
		// TODO Auto-generated method stub
		System.out.println("Enter Student id");
		int id=scan.nextInt();
		System.out.println("Enter Student Name");
		String name=scan.next();
		System.out.println("Enter Student Age");
		int age=scan.nextInt();
		System.out.println("Enter Student Marks");
		double marks=scan.nextDouble();

		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/studentdatabase","root","root");
			PreparedStatement preparedStatement=connection.prepareStatement("insert into student values(?,?,?,?)");
			preparedStatement.setInt(1, id);
			preparedStatement.setString(2, name);
			preparedStatement.setInt(3, age);
			preparedStatement.setDouble(4, marks);
			preparedStatement.execute();
			connection.close();
			System.out.println("Student Data Added");
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	@Override
	public void deleteStudent() {
		// TODO Auto-generated method stub
		System.out.println("Enter the id :");
		int id=scan.nextInt();

		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/studentdatabase","root","root");
			PreparedStatement preparedStatement=connection.prepareStatement("delete from student where id=?");
			preparedStatement.setInt(1, id);
			preparedStatement.execute();
			connection.close();
			System.out.println("Student Date Deleted with ID:"+id);
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	@Override
	public void updateStudent() {
		// TODO Auto-generated method stub
		System.out.println("What you want to update?");
		System.out.println("1.id\n2.Name\n3.Age\n4.Marks");
		int choice =scan.nextInt();
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/studentdatabase","root","root");
				
			switch(choice) {
			case 1:
				System.out.println("Enter the new id");
				int id1=scan.nextInt();
				System.out.println("Enter id of row you want to edit:");
				int id=scan.nextInt();	
				PreparedStatement preparedStatement=connection.prepareStatement("update  student set id=? where id=?");
				preparedStatement.setInt(1, id1);
				preparedStatement.setInt(2, id);
				
				break;
			case 2:
				System.out.println("Enter new name");
				String name=scan.next();
				System.out.println("Enter id of row you want to edit:");
				int id2=scan.nextInt();	
				PreparedStatement preparedStatement2=connection.prepareStatement("update student set name=? where id=?");
				preparedStatement2.setString(1, name);
				preparedStatement2.setInt(2, id2);
				System.out.println("Old Name converted to new name:"+name);
				break;

			case 3:
				System.out.println("Enter new Age");
				int age=scan.nextInt();
				System.out.println("Enter id of row you want to edit:");
				int id3=scan.nextInt();	
				PreparedStatement preparedStatement3=connection.prepareStatement("update student set age=? where id=?");
				preparedStatement3.setInt(1, age);
				preparedStatement3.setInt(2, id3);
				System.out.println("Old Age converted to new Age:"+age);
				break;
			case 4:
				System.out.println("Enter new Marks");
				double marks=scan.nextDouble();
				System.out.println("Enter id of row you want to edit:");
				int id4=scan.nextInt();	
				PreparedStatement preparedStatement4=connection.prepareStatement("update student set marks=? where id=?");
				preparedStatement4.setDouble(1, marks);
				preparedStatement4.setInt(2, id4);
				System.out.println("Old Marks converted to new Marks:"+marks);
				break;

			default:
				System.out.println("Invalid Choice");
			}
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	@Override
	public void getStudentByMarks() {
		// TODO Auto-generated method stub
		System.out.println("Enter >= marks");
		double marks=scan.nextDouble();
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/studentdatabase","root","root");
			PreparedStatement preparedStatement=connection.prepareStatement("select * from student where marks>=?");
			preparedStatement.setDouble(4, marks);
			ResultSet resultset= preparedStatement.executeQuery();
			System.out.println("ID:"+resultset.getInt(1)+",Name:"+resultset.getString(2)+",Age:"+resultset.getInt(3)+",Marks:"+resultset.getDouble(4));
			connection.close();
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	@Override
	public void getAllStudent() {
		// TODO Auto-generated method stub
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/studentdatabase","root","root");
			PreparedStatement preparedStatement=connection.prepareStatement("select * from student ");
			ResultSet resultset= preparedStatement.executeQuery();

			while(resultset.next()) {
				System.out.println("ID:"+resultset.getInt(1)+",Name:"+resultset.getString(2)+",Age:"+resultset.getInt(3)+",Marks:"+resultset.getDouble(4));
			}
			connection.close();
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

}
